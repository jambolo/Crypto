/** @file *//********************************************************************************************************

                                                       Md5.cpp

						                    Copyright 2004, John J. Bolton
	--------------------------------------------------------------------------------------------------------------

	$Header: //depot/Libraries/Crypto/Md5.cpp#3 $

	$NoKeywords: $

 ********************************************************************************************************************/

#include "Md5.h"

#include "Md5Calculator.h"
#include "Common.h"

#include <cstring>
#include <xutility>


namespace Crypto
{


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

Md5::Md5()
{
	memset( &m_digest, 0, sizeof( m_digest ) );
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

Md5::~Md5()
{
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

Md5::Md5( unsigned __int8 const * pData, size_t size )
{
	Md5Calculator().Calculate( pData, size, m_digest );
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

Md5::Md5( std::string const & text )
{
	HexToBinary( text, m_digest, SIZE );
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

Md5::Md5( char const * text )
{
	HexToBinary( text, m_digest, SIZE );
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

std::string Md5::ToString() const
{
	return BinaryToHex( m_digest, SIZE );
}


/********************************************************************************************************************/
/*																													*/
/********************************************************************************************************************/

bool Md5::operator == ( Md5 const & y ) const
{
	return ( memcmp( m_digest, y.m_digest, sizeof( m_digest ) ) == 0 );
}


} // namespace Crypto
